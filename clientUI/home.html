<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, shrink-to-fit=no">
    <title>Lestoran</title>
    <link rel="stylesheet" href="assets/bootstrap/css/bootstrap.min.css">


    <!-- Latest compiled and minified CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">

    <!-- jQuery library -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>

    <!-- Latest compiled JavaScript -->
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>

    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Bitter:400,700">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato:100,300,300i,400,400i,700">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato:300,400">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,700">
    <link rel="stylesheet" href="assets/fonts/font-awesome.min.css">
    <link rel="stylesheet" href="assets/css/Features-Clean.css">
    <link rel="stylesheet" href="assets/css/Header-Blue.css">
    <link rel="stylesheet" href="assets/css/Header-Dark.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.5.2/animate.min.css">
    <link rel="stylesheet" href="assets/css/Responsive-Client-One.css">
    <link rel="stylesheet" href="assets/css/styles.css">

    <!--Include vue-->
    <script src="https://cdn.jsdelivr.net/npm/vue@2/dist/vue.js"></script>
    <script src="https://unpkg.com/axios/dist/axios.js"></script>   
    <script src="https://unpkg.com/vue-router"></script>

</head>

<body>
    <header class="header-dark">
        <nav class="navbar navbar-dark navbar-expand-lg navigation-clean-search">
            <div class="container"><a class="navbar-brand" style="color: rgb(21,133,238);" href="#">Lestoran</a><button data-toggle="collapse" class="navbar-toggler" data-target="#navcol-1"><span class="sr-only">Toggle navigation</span><span class="navbar-toggler-icon"></span></button>
                <div class="collapse navbar-collapse" id="navcol-1" style="text-align: left;">
                    <ul class="navbar-nav ml-auto" style="/*margin: 0px;*/">
                        <li class="nav-item"></li>
                    </ul>
                    <form class="form-inline" id="searchBox" target="_self">
                        <div class="form-group"><label for="search-field"><i class="fa fa-search"></i></label><input class="form-control search-field" type="search" id="search-field" name="search" placeholder="Search restaurant"></div>
                    </form>
                </div>
            </div>
        </nav>
    </header>

        <div class="container-fluid">

            <!--restaurant details-->
            <div id='app'>
                <div class="row features">
                    <div class="col-sm-6 col-lg-12 col-xl-12 offset-xl-3 item">
                        <h2 class="name" style="width: 24em;display: inline-block;">Smiley Restaurant</h2> 
                        <!-- <button class="btn btn-primary text-left" data-bss-hover-animate="flash" type="button" style="background: rgb(76,162,255);text-align: left;">Order Now!</button> -->
                        <p><strong>#B1-69, SMU School of Information Systems</strong></p>
                        <p class="text-left" id="openClose"><strong>Open now</strong></p>
                        <a href="payment.html">
                            <button type="button" class="btn btn-primary btn-lg">Proceed to Payment</button>
                        </a>
                        </div>
                </div>

                <!--retaurant categories-->
                
                <div class="card text-center">
                    <div class="card-header">
                        <ul class="nav nav-tabs card-header-tabs">
                        <li class="nav-item">
                            <a class="nav-link active" href="#">Active</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="#">Link</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link disabled" href="#">Disabled</a>
                        </li>
                        </ul>
                    </div>
                    <div class='container-fluid'>
                    
                        <div v-for="item in items">
                        <!--restaurant items-->
                    
                        <div class="col-sm-4">
                            <div class="card">
                                <div class="card-body">
                                <h5 class="card-title">{{item.name}}</h5>
                                <p class="card-text">{{item.description}}</p>
                                <p class="card-text">$ {{item.price}}</p>
                                <h5 class="card-title">{{item.id}}</h5>
        
                                <div class='row'>
                                        
                                    <div class="input-group-prepend">
                                    <button class="btn btn-outline-secondary" type="button" v-on:click='add(item.id,item.qty)'> 
                                        <span class='glyphicon glyphicon-plus'></span>
                                    </button>
                                    </div>
                                
                                    <input :value='item.qty'>
                                    
                                    <div class='input-group-append'>
                                        <button class="btn btn-outline-secondary" type="button" @click='minus(item.id,item.qty)'>
                                            <span class='glyphicon glyphicon-minus'></span>
                                        </button>
                                    </div> 
        
                                </div>
        
                            </div>
                        </div>
                    </div>
                </div>  
            </div>
        </div> 
    </div>


        <script>

            

            var router = new VueRouter({
                mode:'history',
                routes: []
            });

            new Vue({
                router,
                el: '#app',
                data:{
                    items:[],
                },
                methods:{
                    add:function(id,qty){
                        console.log(id)
                        for (item of this.items){
                            if (item.id == id){
                                console.log('check->',item)
                                item.qty += 1
                            }  
                        }  
                    
                        var obj = JSON.stringify(this.items)
                        var orderlist = localStorage.setItem('orderlist',obj); 
                    
                    },
                    minus:function(id,qty){
                        for (item of this.items){
                            if (item.id == id){
                                console.log('check->',item)
                                if (item.qty != 0){
                                item.qty -= 1
                                }
                            }  
                        }
                        var obj = JSON.stringify(this.items)
                        var orderlist = localStorage.setItem('orderlist',obj);   
                    },
                    
                },
                created: function() { 
                    rest_id = this.$route.query.rest_id
                    axios.get('http://localhost/restaurant/'+rest_id+'/items')
                    .then(response => {
                        restaurant_items = response.data.data
                        console.log(restaurant_items)


                        for (item_obj in restaurant_items) {
                            new_item_obj = restaurant_items[item_obj]
                            new_item_obj['rest_id'] = rest_id
                            new_item_obj['qty'] = 0
                            new_item_obj['id'] = item_obj
                            this.items.push(restaurant_items[item_obj])
                        }
           
                        console.log('->items',this.items)
                        
                        
                    })
                    .catch(error => {
                        this.res = [{ entry: 'There was an error: ' + error.message }]
                    })
            }
                
            })
        </script>

    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"
    integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj"
    crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js"
    integrity="sha384-9/reFTGAW83EW2RDu2S0VKaIzap3H66lZH81PoYlFhbGU+6BZp6G7niu735Sk7lN"
    crossorigin="anonymous"></script>
</body>

</html>