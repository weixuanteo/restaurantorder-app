<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, shrink-to-fit=no">
    <title>Lestoran</title>
    <link rel="stylesheet" href="assets/bootstrap/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Bitter:400,700">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato:100,300,300i,400,400i,700">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato:300,400">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,700">
    <link rel="stylesheet" href="assets/fonts/font-awesome.min.css">
    <link rel="stylesheet" href="assets/css/Features-Clean.css">
    <link rel="stylesheet" href="assets/css/Header-Blue.css">
    <link rel="stylesheet" href="assets/css/Header-Dark.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.5.2/animate.min.css">
    <link rel="stylesheet" href="assets/css/Responsive-Client-One.css">
    <link rel="stylesheet" href="assets/css/styles.css">
</head>

<!--Include vue-->
<script src="https://cdn.jsdelivr.net/npm/vue@2/dist/vue.js"></script>
<script src="https://unpkg.com/axios/dist/axios.js"></script>   
<script src="https://unpkg.com/vue-router"></script>

<body>
    <header class="header-dark">
        <nav class="navbar navbar-dark navbar-expand-lg navigation-clean-search">
            <div class="container"><a class="navbar-brand" style="color: rgb(21,133,238);" href="#">Lestoran</a><button data-toggle="collapse" class="navbar-toggler" data-target="#navcol-1"><span class="sr-only">Toggle navigation</span><span class="navbar-toggler-icon"></span></button>
                <div class="collapse navbar-collapse" id="navcol-1" style="text-align: left;">
                    <ul class="navbar-nav ml-auto" style="/*margin: 0px;*/">
                        <li class="nav-item"></li>
                    </ul>
                </div>
            </div>
        </nav>
        <h3 class="name" style="display: inline-block;margin-left: 5em;"><strong>Order summary</strong><br></h3>
    </header>
    <div id='app'>
    <div id="orderTable">
        <div class="table-responsive">
            
            <table class="table">
                <thead>
                <tr>
                    <th id="serialColumn">S/N</th>
                    <th>ITEM</th>
                    <th id="priceColumn">QUANTITY</th>
                    <th id="priceColumn">PRICE</th>
                </tr>
                </thead>
                <tbody>
                    <tr v-for="order in orderlist">
                        <td>{{count++}}</td>
                        <td>{{order.name}}</td>
                        <td>{{order.qty}}</td>
                        <td>{{order.price}}</td>
                    </tr>
                </tbody>
                </table>
            </div>
            </div>
    <div id="paymentDetails">
        <div class="table-responsive" id="summaryTable">
            <table class="table">
                <thead>
                    <tr>
                        <th>Payment details</th>
                        <th></th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><strong>Total</strong></td>
                        <td><strong>{{totalcost}}</strong></td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>

    <div id="buttonHolder"><button class="btn btn-primary" id="submitOrder" type="button">Place order</button></div>
    </div>
    <script>


        new Vue({
            el: '#app',
            data: {
                orderlist: [],
                count:1,
                totalcost:0
            },
            created: function() { 
                allorderlist = JSON.parse(localStorage.getItem('orderlist'));
                console.log(allorderlist);
                for (order of allorderlist){
                    if (order.qty > 0){
                       this.orderlist.push(order)
                       this.totalcost += order.qty * order.price
                    }
                }
            },
            methods:{
                placeorder:function(){
                console.log('->placing order')
                axios.post('http://order-service:5000/order/neworder')
                .then(response => {
                    payload = this.oderlist
                    all_restaurants = response.data.data.restaurants
                    for (restaurant of all_restaurants) {
                        console.log(restaurant)
                        this.restaurants.push(restaurant)
                    }
                })
                .catch(error => {
                    this.res = [{ entry: 'There was an error: ' + error.message }]
                })
            }
        }})


//notification -> order status



    </script>
    <script src="assets/js/jquery.min.js"></script>
    <script src="assets/bootstrap/js/bootstrap.min.js"></script>
    <script src="assets/js/bs-init.js"></script>
</body>

</html>