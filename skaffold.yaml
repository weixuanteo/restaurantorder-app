apiVersion: skaffold/v2beta12
kind: Config
metadata:
  name: restaurantorder-app
build:
  googleCloudBuild:
      projectId: restaurantorder-sg
  artifacts:
  - image: gcr.io/restaurantorder-sg/owner
    context: owner
    sync:
      manual:
        - src: "*.py"
          dest: "."
    docker:
      dockerfile: Dockerfile
  - image: gcr.io/restaurantorder-sg/order
    context: order
    sync:
      manual:
        - src: "*.py"
          dest: "."
    docker:
      dockerfile: Dockerfile
  - image: gcr.io/restaurantorder-sg/restaurant
    context: restaurant
    sync:
      manual:
        - src: "*.py"
          dest: "."
    docker:
      dockerfile: Dockerfile

deploy:
  kubectl:
    manifests:
    - k8s/ingress.yaml
    # - k8s/mariadb-definition.yaml
    # - k8s/mariadb-pv.yaml
    - k8s/owner-definition.yaml
    - k8s/restaurant-definition.yaml
    - k8s/order-definition.yaml
    